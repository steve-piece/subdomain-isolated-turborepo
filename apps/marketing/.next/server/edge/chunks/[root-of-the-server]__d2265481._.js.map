{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 23, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/lib/utils.ts"],"sourcesContent":["import { clsx, type ClassValue } from 'clsx';\nimport { twMerge } from 'tailwind-merge';\n\nexport const protocol =\n  process.env.NODE_ENV === 'production' ? 'https' : 'http';\n\n// Marketing domain (public website)\nexport const marketingDomain =\n  process.env.NEXT_PUBLIC_MARKETING_DOMAIN ||\n  process.env.NEXT_PUBLIC_ROOT_DOMAIN ||\n  'localhost:3000';\n\n// App domain (protected routes and tenant subdomains)\nexport const appDomain =\n  process.env.NEXT_PUBLIC_APP_DOMAIN || 'localhost:3000';\n\n// Back-compat: some places may still import rootDomain; treat as marketing domain\nexport const rootDomain = marketingDomain;\n\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs));\n}\n"],"names":[],"mappings":";;;;;;;AAAA;AACA;;;AAEO,MAAM,WACX,6EAAkD;AAG7C,MAAM,kBACX,QAAQ,GAAG,CAAC,4BAA4B,IACxC,QAAQ,GAAG,CAAC,uBAAuB,IACnC;AAGK,MAAM,YACX,QAAQ,GAAG,CAAC,sBAAsB,IAAI;AAGjC,MAAM,aAAa;AAEnB,SAAS,GAAG,GAAG,MAAoB;IACxC,OAAO,CAAA,GAAA,mKAAA,CAAA,UAAO,AAAD,EAAE,CAAA,GAAA,6IAAA,CAAA,OAAI,AAAD,EAAE;AACtB"}},
    {"offset": {"line": 47, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/middleware.ts"],"sourcesContent":["import { type NextRequest, NextResponse } from 'next/server';\nimport { marketingDomain, appDomain } from '@/lib/utils';\n\nfunction extractSubdomain(request: NextRequest): string | null {\n  const url = request.url;\n  const host = request.headers.get('host') || '';\n  const hostname = host.split(':')[0];\n\n  // Local development environment\n  if (url.includes('localhost') || url.includes('127.0.0.1')) {\n    // Try to extract subdomain from the full URL\n    const fullUrlMatch = url.match(/http:\\/\\/([^.]+)\\.localhost/);\n    if (fullUrlMatch && fullUrlMatch[1]) {\n      return fullUrlMatch[1];\n    }\n\n    // Fallback to host header approach\n    if (hostname.includes('.localhost')) {\n      return hostname.split('.')[0];\n    }\n\n    return null;\n  }\n\n  // Production environment\n  const appRoot = appDomain.split(':')[0];\n  const marketingRoot = marketingDomain.split(':')[0];\n\n  // Handle preview deployment URLs (tenant---branch-name.vercel.app)\n  if (hostname.includes('---') && hostname.endsWith('.vercel.app')) {\n    const parts = hostname.split('---');\n    return parts.length > 0 ? parts[0] : null;\n  }\n\n  // Regular subdomain detection â€” only treat subdomains under app domain as tenants\n  const isSubdomain =\n    hostname !== appRoot &&\n    hostname !== `www.${appRoot}` &&\n    hostname.endsWith(`.${appRoot}`);\n\n  // Do not consider subdomains under marketing domain as tenants\n  if (\n    hostname !== marketingRoot &&\n    hostname !== `www.${marketingRoot}` &&\n    hostname.endsWith(`.${marketingRoot}`)\n  ) {\n    return null;\n  }\n\n  return isSubdomain ? hostname.replace(`.${appRoot}`, '') : null;\n}\n\nexport async function middleware(request: NextRequest) {\n  const { pathname } = request.nextUrl;\n  const subdomain = extractSubdomain(request);\n  const host = request.headers.get('host') || '';\n  const hostname = host.split(':')[0];\n  const appRoot = appDomain.split(':')[0];\n  const marketingRoot = marketingDomain.split(':')[0];\n\n  // If request is for the marketing domain, ensure admin is accessible and no tenant rewrite\n  if (hostname === marketingRoot || hostname === `www.${marketingRoot}`) {\n    // Marketing domain: never rewrite to tenant pages\n    return NextResponse.next();\n  }\n\n  if (subdomain) {\n    // Block access to admin page from subdomains\n    if (pathname.startsWith('/admin')) {\n      // Send them to marketing admin\n      const protocol = request.nextUrl.protocol; // includes ':'\n      return NextResponse.redirect(new URL('/admin', `${protocol}//${marketingRoot}`));\n    }\n\n    // Rewrite all tenant subdomain paths to /s/[subdomain]/...\n    const targetPath = pathname === '/' ? `/s/${subdomain}` : `/s/${subdomain}${pathname}`;\n    return NextResponse.rewrite(new URL(targetPath, request.url));\n  }\n\n  // On the app root or anywhere else, allow normal access\n  return NextResponse.next();\n}\n\nexport const config = {\n  matcher: [\n    /*\n     * Match all paths except for:\n     * 1. /api routes\n     * 2. /_next (Next.js internals)\n     * 3. all root files inside /public (e.g. /favicon.ico)\n     */\n    '/((?!api|_next|[\\\\w-]+\\\\.\\\\w+).*)'\n  ]\n};\n"],"names":[],"mappings":";;;;AAAA;AAAA;AACA;;;AAEA,SAAS,iBAAiB,OAAoB;IAC5C,MAAM,MAAM,QAAQ,GAAG;IACvB,MAAM,OAAO,QAAQ,OAAO,CAAC,GAAG,CAAC,WAAW;IAC5C,MAAM,WAAW,KAAK,KAAK,CAAC,IAAI,CAAC,EAAE;IAEnC,gCAAgC;IAChC,IAAI,IAAI,QAAQ,CAAC,gBAAgB,IAAI,QAAQ,CAAC,cAAc;QAC1D,6CAA6C;QAC7C,MAAM,eAAe,IAAI,KAAK,CAAC;QAC/B,IAAI,gBAAgB,YAAY,CAAC,EAAE,EAAE;YACnC,OAAO,YAAY,CAAC,EAAE;QACxB;QAEA,mCAAmC;QACnC,IAAI,SAAS,QAAQ,CAAC,eAAe;YACnC,OAAO,SAAS,KAAK,CAAC,IAAI,CAAC,EAAE;QAC/B;QAEA,OAAO;IACT;IAEA,yBAAyB;IACzB,MAAM,UAAU,oHAAA,CAAA,YAAS,CAAC,KAAK,CAAC,IAAI,CAAC,EAAE;IACvC,MAAM,gBAAgB,oHAAA,CAAA,kBAAe,CAAC,KAAK,CAAC,IAAI,CAAC,EAAE;IAEnD,mEAAmE;IACnE,IAAI,SAAS,QAAQ,CAAC,UAAU,SAAS,QAAQ,CAAC,gBAAgB;QAChE,MAAM,QAAQ,SAAS,KAAK,CAAC;QAC7B,OAAO,MAAM,MAAM,GAAG,IAAI,KAAK,CAAC,EAAE,GAAG;IACvC;IAEA,kFAAkF;IAClF,MAAM,cACJ,aAAa,WACb,aAAa,CAAC,IAAI,EAAE,SAAS,IAC7B,SAAS,QAAQ,CAAC,CAAC,CAAC,EAAE,SAAS;IAEjC,+DAA+D;IAC/D,IACE,aAAa,iBACb,aAAa,CAAC,IAAI,EAAE,eAAe,IACnC,SAAS,QAAQ,CAAC,CAAC,CAAC,EAAE,eAAe,GACrC;QACA,OAAO;IACT;IAEA,OAAO,cAAc,SAAS,OAAO,CAAC,CAAC,CAAC,EAAE,SAAS,EAAE,MAAM;AAC7D;AAEO,eAAe,WAAW,OAAoB;IACnD,MAAM,EAAE,QAAQ,EAAE,GAAG,QAAQ,OAAO;IACpC,MAAM,YAAY,iBAAiB;IACnC,MAAM,OAAO,QAAQ,OAAO,CAAC,GAAG,CAAC,WAAW;IAC5C,MAAM,WAAW,KAAK,KAAK,CAAC,IAAI,CAAC,EAAE;IACnC,MAAM,UAAU,oHAAA,CAAA,YAAS,CAAC,KAAK,CAAC,IAAI,CAAC,EAAE;IACvC,MAAM,gBAAgB,oHAAA,CAAA,kBAAe,CAAC,KAAK,CAAC,IAAI,CAAC,EAAE;IAEnD,2FAA2F;IAC3F,IAAI,aAAa,iBAAiB,aAAa,CAAC,IAAI,EAAE,eAAe,EAAE;QACrE,kDAAkD;QAClD,OAAO,6LAAA,CAAA,eAAY,CAAC,IAAI;IAC1B;IAEA,IAAI,WAAW;QACb,6CAA6C;QAC7C,IAAI,SAAS,UAAU,CAAC,WAAW;YACjC,+BAA+B;YAC/B,MAAM,WAAW,QAAQ,OAAO,CAAC,QAAQ,EAAE,eAAe;YAC1D,OAAO,6LAAA,CAAA,eAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,UAAU,GAAG,SAAS,EAAE,EAAE,eAAe;QAChF;QAEA,2DAA2D;QAC3D,MAAM,aAAa,aAAa,MAAM,CAAC,GAAG,EAAE,WAAW,GAAG,CAAC,GAAG,EAAE,YAAY,UAAU;QACtF,OAAO,6LAAA,CAAA,eAAY,CAAC,OAAO,CAAC,IAAI,IAAI,YAAY,QAAQ,GAAG;IAC7D;IAEA,wDAAwD;IACxD,OAAO,6LAAA,CAAA,eAAY,CAAC,IAAI;AAC1B;AAEO,MAAM,SAAS;IACpB,SAAS;QACP;;;;;KAKC,GACD;KACD;AACH"}}]
}